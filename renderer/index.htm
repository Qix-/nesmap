<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>NES Map Editor</title>
		<script type="text/javascript" src="coffee-script.js"></script>
		<script type="text/coffeescript" src="keybindings.coffee"></script>
		<script type="text/coffeescript" src="bootstrap.coffee"></script>
		<script type="text/coffeescript" src="renderer.coffee"></script>
		<link rel="stylesheet" href="styles.css" />
	</head>
	<body>
		<canvas-container>
			<canvas id="map"></canvas>
		</canvas-container>
		<zoom-slider>
			<input id="zoom" type="range" min="1" max="10" step="0.1" />
		</zoom-slider>
		<sidebar>
			<section>
				<h2>Tile Picker</h2>
				<tile-picker></tile-picker>
			</section>

			<section>
				<h2>Nesmap</h2>
				<map-option>
					<h3>Mirroring</h3>
					<span>
						<select id="mirroring"></select>
					</span>
				</map-option>
			</section>

			<section>
				<h2>CHR Pages</h2>
				<map-option id="chr-page-selector">
					<input type="number" />
					<input type="number" />
					<input type="number" />
					<input type="number" />
				</map-option>
			</section>
		</sidebar>

		<script type="text/coffeescript">
			Keys.attach()

			window.renderer = new Renderer document.querySelector 'canvas#map'

			zoomer = document.getElementById 'zoom'
			zoomer.value = renderer.zoom
			zoomer.addEventListener 'input', (e) ->
				renderer.setZoom this.value

			mirrorSelector = document.getElementById 'mirroring'
			renderer.on 'mirrors', (mirrors) ->
				mirrorSelector.innerHTML = ''
				for v, i in mirrors
					option = document.createElement 'option'
					option.value = i
					option.innerHTML = v.name
					mirrorSelector.appendChild option

			renderer.on 'nesmap', (nesmap) ->
				mirrorSelector.selectedIndex = nesmap.nametableMirroring

			mirrorSelector.addEventListener 'change', (e) ->
				renderer.setNametableMirroring this.selectedIndex
		</script>
	</body>
</html>
